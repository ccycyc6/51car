C51 COMPILER V9.59.0.0   TESTMOTOR                                                         05/16/2025 15:48:53 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE TESTMOTOR
OBJECT MODULE PLACED IN .\Objects\testmotor.obj
COMPILER INVOKED BY: D:\keil 5\C51\BIN\C51.EXE testmotor.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\
                    -testmotor.lst) TABS(2) OBJECT(.\Objects\testmotor.obj)

line level    source

   1          #include <reg52.h>
   2          
   3          sbit in1 = P1^0;
   4          sbit in2 = P1^1;
   5          sbit ENA1 = P0^0;
   6          sbit in3 = P1^2;
   7          sbit in4 = P1^3;
   8          sbit ENA2 = P0^1; 
   9          
  10          
  11          void delay(unsigned int z);
  12          void delay_us(unsigned int aa);
  13          
  14          void main(){
  15   1          while(1)
  16   1          {
  17   2              unsigned int i, cycle=0, T = 1024; // 减少T到512（1/4）
  18   2              in1 = 1;
  19   2              in2 = 0;
  20   2              in3 = 1;
  21   2              in4 = 0;
  22   2              for(i=0;i<100;i++) 
  23   2              {
  24   3                  delay(10); // 保持50%占空比，延时不变
  25   3                  ENA1 = ~ENA1;
  26   3                  ENA2 = ~ENA2;
  27   3              }
  28   2              in1 = 0;
  29   2              in2 = 1;
  30   2              in3 = 0;
  31   2              in4 = 1;
  32   2              for(i=0;i<100;i++)
  33   2              {
  34   3                  delay(20); // 保持50%占空比，延时不变
  35   3                  ENA1 = ~ENA1;
  36   3                  ENA2 = ~ENA2;
  37   3              }
  38   2              in1 = 1;
  39   2              in2 = 0;
  40   2              in3 = 1;
  41   2              in4 = 0;
  42   2              while(cycle!=T) // T从2048减少到512
  43   2              {
  44   3                  ENA1 = 1;
  45   3                  ENA2 = 1;
  46   3                  delay_us(cycle++);
  47   3                  ENA1 = 0;
  48   3                  ENA2 = 0;
  49   3                  delay_us(T-cycle);
  50   3              }
  51   2              in1=0;
  52   2              in2=1;
  53   2              in3=0;
  54   2              in4=1;
C51 COMPILER V9.59.0.0   TESTMOTOR                                                         05/16/2025 15:48:53 PAGE 2   

  55   2              while(cycle!=T) // T从2048减少到512
  56   2              {
  57   3                  ENA1 = 1;
  58   3                  ENA2 = 1;
  59   3                  delay_us(cycle++);
  60   3                  ENA1 = 0;
  61   3                  ENA2 = 0;
  62   3                  delay_us(T-cycle);
  63   3              }
  64   2          }
  65   1      }
  66          
  67          void delay(unsigned int z)
  68          {
  69   1          unsigned int x, y;
  70   1          for(x=z;x>0;x--)
  71   1              for(y=110;y>0;y--);
  72   1      }
  73          
  74          void delay_us(unsigned int aa)
  75          {
  76   1          while(aa--);
  77   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    238    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
